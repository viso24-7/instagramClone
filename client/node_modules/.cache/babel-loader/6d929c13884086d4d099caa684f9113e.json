{"ast":null,"code":"import _objectSpread from\"C:\\\\JavascriptProjects3\\\\instagramClone\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\JavascriptProjects3\\\\instagramClone\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\JavascriptProjects3\\\\instagramClone\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import{post}from'axios';import{notify}from'../utils/utilMethods/handy-notification';import{addGroupPost,addUserPost}from'../actions/post';import{imageCompressor,insta_notify,Me,uData,wait}from'./utils';import*as PostActions from'../actions/post';import Action from'./api/Action';import d from'./api/Dom';/**\r\n * Add post\r\n * @param {Object} options Options for creating a new post\r\n * @param {Function} options.dispatch\r\n * @param {String} options.desc\r\n * @param {String} options.targetFile\r\n * @param {String} options.filter\r\n * @param {String} options.location\r\n * @param {String} options.type\r\n * @param {Number} options.group\r\n * @param {String} options.group_name\r\n * @param {Object[]} options.tags\r\n * @param {Number} options.tags.user\r\n * @param {String} options.tags.username\r\n */export var addPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(options){var group,group_name,tags,desc,location,type,filter,targetFile,dispatch,user,username,form,file,action,_yield$post,_yield$post$data,success,message,post_id,firstname,surname,filename,newPost;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:group=options.group,group_name=options.group_name,tags=options.tags,desc=options.desc,location=options.location,type=options.type,filter=options.filter,targetFile=options.targetFile,dispatch=options.dispatch;user=Number(uData('session'));username=uData('username');form=new FormData();_context2.next=6;return imageCompressor(targetFile);case 6:file=_context2.sent;action=new Action('.p_post');action.start();wait();form.append('desc',desc);form.append('image',file);form.append('filter',filter);form.append('location',location);form.append('type',type);form.append('group',group);_context2.next=18;return post('/api/post-it',form);case 18:_yield$post=_context2.sent;_yield$post$data=_yield$post.data;success=_yield$post$data.success;message=_yield$post$data.message;post_id=_yield$post$data.post_id;firstname=_yield$post$data.firstname;surname=_yield$post$data.surname;filename=_yield$post$data.filename;_context2.next=28;return post('/api/tag-post',{tags:tags,post_id:post_id});case 28:tags.forEach(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(t){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return insta_notify({to:t.user,type:'tag',post_id:post_id});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());if(success){newPost={key:post_id,comments_count:0,likes_count:0,shares_count:0,tags_count:tags.length,user:user,username:username,firstname:firstname,surname:surname,description:desc,filter:filter,imgSrc:filename,location:location,post_time:\"\".concat(new Date().getTime()),post_id:post_id,group_id:0,group_name:'',type:'user'};type==='user'?dispatch(addUserPost(_objectSpread(_objectSpread({},newPost),{},{when:'feed'}))):dispatch(addGroupPost(_objectSpread(_objectSpread({},newPost),{},{group_id:group,group_name:group_name,type:'group',when:'groupPosts'})));}action.end();notify({value:message});case 32:case\"end\":return _context2.stop();}}},_callee2);}));return function addPost(_x){return _ref.apply(this,arguments);};}();/**\r\n * Edit post\r\n *\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.description\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.done\r\n * @param {Function} options.failed\r\n */export var editPost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(options){var post_id,description,dispatch,done,failed,_yield$post2,_yield$post2$data,success,message;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:post_id=options.post_id,description=options.description,dispatch=options.dispatch,done=options.done,failed=options.failed;_context3.next=3;return post('/api/edit-post',{description:description,post_id:post_id});case 3:_yield$post2=_context3.sent;_yield$post2$data=_yield$post2.data;success=_yield$post2$data.success;message=_yield$post2$data.message;if(success){dispatch(PostActions.editPost({post_id:post_id,description:description}));done();}notify({value:message});case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function editPost(_x3){return _ref3.apply(this,arguments);};}();/**\r\n * Deletes a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.when\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.redirect\r\n */export var deletePost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(options){var post_id,when,dispatch,redirect,_yield$post3,_yield$post3$data,success,message;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:post_id=options.post_id,when=options.when,dispatch=options.dispatch,redirect=options.redirect;wait();_context4.next=4;return post('/api/delete-post',{post:post_id});case 4:_yield$post3=_context4.sent;_yield$post3$data=_yield$post3.data;success=_yield$post3$data.success;message=_yield$post3$data.message;if(!success){_context4.next=11;break;}dispatch(PostActions.deletePost(post_id));return _context4.abrupt(\"return\",when==='viewPost'?redirect():null);case 11:notify({value:message});case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function deletePost(_x4){return _ref4.apply(this,arguments);};}();/**\r\n * Like post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Number} options.user\r\n * @param {Function} options.done\r\n */export var like=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(options){var post_id,user,done,_yield$post4,_yield$post4$data,success,message;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:post_id=options.post_id,user=options.user,done=options.done;_context5.next=3;return post('/api/like-post',{post:post_id});case 3:_yield$post4=_context5.sent;_yield$post4$data=_yield$post4.data;success=_yield$post4$data.success;message=_yield$post4$data.message;if(!success){_context5.next=12;break;}return _context5.abrupt(\"return\",!Me(user)?insta_notify({to:user,type:'like',post_id:post_id}):null);case 12:notify({value:message});case 13:case\"end\":return _context5.stop();}}},_callee5);}));return function like(_x5){return _ref5.apply(this,arguments);};}();/**\r\n * Unlikes a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */export var unlike=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(options){var post_id,done,_yield$post5,_yield$post5$data,success,message;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:post_id=options.post_id,done=options.done;_context6.next=3;return post('/api/unlike-post',{post_id:post_id});case 3:_yield$post5=_context6.sent;_yield$post5$data=_yield$post5.data;success=_yield$post5$data.success;message=_yield$post5$data.message;success?done():notify({value:message});case 8:case\"end\":return _context6.stop();}}},_callee6);}));return function unlike(_x6){return _ref6.apply(this,arguments);};}();/**\r\n * Bookmarks a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */export var bookmark=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(options){var post_id,done,_yield$post6,_yield$post6$data,success,message;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:post_id=options.post_id,done=options.done;_context7.next=3;return post('/api/bookmark-post',{post_id:post_id});case 3:_yield$post6=_context7.sent;_yield$post6$data=_yield$post6.data;success=_yield$post6$data.success;message=_yield$post6$data.message;return _context7.abrupt(\"return\",success?done():null);case 9:case\"end\":return _context7.stop();}}},_callee7);}));return function bookmark(_x7){return _ref7.apply(this,arguments);};}();/**\r\n * Unbookmark post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.when\r\n * @param {Number} options.user\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.done\r\n */export var unbookmark=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(options){var user,post_id,when,dispatch,done,session,_yield$post7,_yield$post7$data,success,message;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:user=options.user,post_id=options.post_id,when=options.when,dispatch=options.dispatch,done=options.done;session=uData('session');_context8.next=4;return post('/api/unbookmark-post',{post:post_id,user:session});case 4:_yield$post7=_context8.sent;_yield$post7$data=_yield$post7.data;success=_yield$post7$data.success;message=_yield$post7$data.message;if(success){if(when==='bookmarks'&&Me(user)){dispatch(PostActions.unbookmark(post_id));notify({value:'Post unbookmarked'});}done();}else{notify({value:message});}case 9:case\"end\":return _context8.stop();}}},_callee8);}));return function unbookmark(_x8){return _ref8.apply(this,arguments);};}();/**\r\n *  Share post\r\n * @param {Object} options\r\n * @param {Number} options.user\r\n * @param {Number} options.post_id\r\n * @param {Number} options.postOwner\r\n * @param {Function} options.done\r\n */export var share=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(options){var user,post_id,postOwner,done,_yield$post8,_yield$post8$data,success,message;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:user=options.user,post_id=options.post_id,postOwner=options.postOwner,done=options.done;new d('.share_btn').blur();_context9.next=4;return post('/api/share-post',{share_to:user,post_id:post_id});case 4:_yield$post8=_context9.sent;_yield$post8$data=_yield$post8.data;success=_yield$post8$data.success;message=_yield$post8$data.message;if(!success){_context9.next=12;break;}insta_notify({to:user,type:'share',post_id:post_id});return _context9.abrupt(\"return\",!Me(postOwner)?insta_notify({to:postOwner,type:'shared_your_post',post_id:post_id}):null);case 12:notify({value:message});case 13:case\"end\":return _context9.stop();}}},_callee9);}));return function share(_x9){return _ref9.apply(this,arguments);};}();/**\r\n * Unshare post\r\n * @param {Object} options\r\n * @param {Number} options.user\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */export var unshare=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(options){var user,post_id,done,_yield$post9,_yield$post9$data,success,message;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:user=options.user,post_id=options.post_id,done=options.done;_context10.next=3;return post('/api/unshare-post',{unshare_to:user,post_id:post_id});case 3:_yield$post9=_context10.sent;_yield$post9$data=_yield$post9.data;success=_yield$post9$data.success;message=_yield$post9$data.message;return _context10.abrupt(\"return\",success?done():null);case 9:case\"end\":return _context10.stop();}}},_callee10);}));return function unshare(_x10){return _ref10.apply(this,arguments);};}();","map":{"version":3,"sources":["C:/JavascriptProjects3/instagramClone/client/src/utils/post-utils.js"],"names":["post","notify","addGroupPost","addUserPost","imageCompressor","insta_notify","Me","uData","wait","PostActions","Action","d","addPost","options","group","group_name","tags","desc","location","type","filter","targetFile","dispatch","user","Number","username","form","FormData","file","action","start","append","data","success","message","post_id","firstname","surname","filename","forEach","t","to","newPost","key","comments_count","likes_count","shares_count","tags_count","length","description","imgSrc","post_time","Date","getTime","group_id","when","end","value","editPost","done","failed","deletePost","redirect","like","unlike","bookmark","unbookmark","session","share","postOwner","blur","share_to","unshare","unshare_to"],"mappings":"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","sourcesContent":["import {post} from 'axios';\r\nimport {notify} from '../utils/utilMethods/handy-notification';\r\nimport {addGroupPost,addUserPost} from '../actions/post';\r\nimport {imageCompressor,insta_notify,Me,uData,wait} from './utils';\r\nimport * as PostActions from '../actions/post'\r\nimport Action from './api/Action';\r\nimport d from './api/Dom';\r\n\r\n\r\n/**\r\n * Add post\r\n * @param {Object} options Options for creating a new post\r\n * @param {Function} options.dispatch\r\n * @param {String} options.desc\r\n * @param {String} options.targetFile\r\n * @param {String} options.filter\r\n * @param {String} options.location\r\n * @param {String} options.type\r\n * @param {Number} options.group\r\n * @param {String} options.group_name\r\n * @param {Object[]} options.tags\r\n * @param {Number} options.tags.user\r\n * @param {String} options.tags.username\r\n */\r\n export const addPost = async options => {\r\n     let {group,group_name,tags,desc,location,type,filter,targetFile,dispatch} = options;\r\n     let user = Number(uData('session'));\r\n     let username = uData('username');\r\n     let form = new FormData();\r\n     let file = await imageCompressor(targetFile);\r\n     let action = new Action('.p_post');\r\n\r\n     action.start();\r\n     wait();\r\n\r\n     form.append('desc',desc);\r\n     form.append('image',file);\r\n     form.append('filter',filter);\r\n     form.append('location',location);\r\n     form.append('type',type);\r\n     form.append('group',group);\r\n\r\n     let {data: {success,message,post_id,firstname,surname,filename}} = await post('/api/post-it',form)\r\n          await post('/api/tag-post',{tags,post_id})\r\n     \r\n     tags.forEach(async t => {\r\n         await insta_notify({\r\n             to: t.user,\r\n             type: 'tag',\r\n             post_id: post_id\r\n         })\r\n     })\r\n     \r\n     if(success){\r\n        let newPost = {\r\n            key: post_id,\r\n            comments_count: 0,\r\n            likes_count: 0,\r\n            shares_count: 0,\r\n            tags_count: tags.length,\r\n            user,\r\n            username,\r\n            firstname,\r\n            surname,\r\n            description: desc,\r\n            filter,\r\n            imgSrc: filename,\r\n            location,\r\n            post_time: `${new Date().getTime()}`,\r\n            post_id,\r\n            group_id: 0,\r\n            group_name: '',\r\n            type: 'user'\r\n        };\r\n      \r\n        type === 'user' ? dispatch(addUserPost({\r\n            ...newPost,\r\n            when: 'feed'\r\n        })) : dispatch(addGroupPost({\r\n            ...newPost,\r\n            group_id: group,\r\n            group_name,\r\n            type: 'group',\r\n            when: 'groupPosts'\r\n        }))\r\n     }\r\n\r\n     action.end();\r\n     notify({ value: message})\r\n } \r\n\r\n/**\r\n * Edit post\r\n *\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.description\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.done\r\n * @param {Function} options.failed\r\n */\r\n export const editPost = async options => {\r\n     let {post_id,description,dispatch,done,failed} = options;\r\n     let {data: {success,message}} = await post('/api/edit-post',{description,post_id});\r\n\r\n     if(success){\r\n         dispatch(PostActions.editPost({\r\n             post_id,\r\n             description\r\n          }));\r\n         done(); \r\n     }\r\n   \r\n   notify({ value: message })  \r\n }\r\n\r\n/**\r\n * Deletes a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.when\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.redirect\r\n */\r\n export const deletePost = async options => {\r\n     let {post_id,when,dispatch,redirect} = options;\r\n\r\n     wait();\r\n     let {data: {success,message}} = await post('/api/delete-post',{post: post_id});\r\n     if(success){\r\n         dispatch(PostActions.deletePost(post_id));\r\n         return when === 'viewPost' ? redirect() : null\r\n     }\r\n\r\n    notify({ value: message})  \r\n }\r\n\r\n/**\r\n * Like post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Number} options.user\r\n * @param {Function} options.done\r\n */\r\n export const like = async options => {\r\n     let {post_id,user,done} = options;\r\n     let {data: {success,message}} = await post('/api/like-post',{post: post_id});\r\n\r\n     if(success){\r\n       return !Me(user) ? insta_notify({\r\n             to: user,\r\n             type: 'like',\r\n             post_id\r\n         }) : null\r\n        done(); \r\n     }else {\r\n     notify({value: message})  \r\n   } \r\n } \r\n\r\n/**\r\n * Unlikes a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */\r\n export const unlike = async options => {\r\n     let {post_id,done} = options;\r\n     let {data:{success,message}} = await post('/api/unlike-post',{post_id});\r\n     success ? done() : notify({ value: message})\r\n }\r\n\r\n /**\r\n * Bookmarks a post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */\r\n export const bookmark = async options => {\r\n     let {post_id,done} = options;\r\n     let {data:{success,message}} = await post('/api/bookmark-post',{post_id});\r\n\r\n     return success ? done() : null\r\n     notify({ value: message})\r\n }\r\n\r\n/**\r\n * Unbookmark post\r\n * @param {Object} options\r\n * @param {Number} options.post_id\r\n * @param {String} options.when\r\n * @param {Number} options.user\r\n * @param {Function} options.dispatch\r\n * @param {Function} options.done\r\n */\r\n export const unbookmark = async options => {\r\n     let {user,post_id,when,dispatch,done} = options;\r\n     let session = uData('session');\r\n     let {data: {success,message}} = await post('/api/unbookmark-post',{post: post_id,user: session});\r\n\r\n     if(success){\r\n         if(when === 'bookmarks' && Me(user)){\r\n             dispatch(PostActions.unbookmark(post_id));\r\n             notify({ value: 'Post unbookmarked'})\r\n         }\r\n         done()\r\n     } else {\r\n    notify({ value: message})    \r\n   }\r\n }\r\n\r\n/**\r\n *  Share post\r\n * @param {Object} options\r\n * @param {Number} options.user\r\n * @param {Number} options.post_id\r\n * @param {Number} options.postOwner\r\n * @param {Function} options.done\r\n */\r\n export const share = async options => {\r\n     let {user,post_id,postOwner,done} = options;\r\n     new d('.share_btn').blur();\r\n     let {data: {success,message}} = await post('/api/share-post',{share_to: user,post_id});\r\n\r\n     if(success){\r\n         insta_notify({\r\n             to: user,\r\n             type: 'share',\r\n             post_id\r\n         })\r\n\r\n         return !Me(postOwner) ? insta_notify({\r\n             to: postOwner,\r\n             type: 'shared_your_post',\r\n             post_id\r\n         }) : null\r\n         \r\n         done();\r\n     }\r\n  \r\n     notify({value: message})\r\n }\r\n\r\n/**\r\n * Unshare post\r\n * @param {Object} options\r\n * @param {Number} options.user\r\n * @param {Number} options.post_id\r\n * @param {Function} options.done\r\n */\r\n export const unshare = async options => {\r\n     let {user,post_id,done} = options;\r\n     let {data: {success,message}} = await post('/api/unshare-post',{unshare_to: user,post_id});\r\n\r\n     return success ? done() : null\r\n     notify({value: message})\r\n }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}